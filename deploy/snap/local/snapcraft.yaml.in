name: rtpmidid
base: core20
version: '@RTPMIDID_VERSION@'
summary: rtpmidid allows you to share ALSA sequencer devices on the network
description: |
  rtpmidid allows you to share ALSA sequencer devices on the network using
  RTP MIDI, and import other network shared RTP MIDI devices.
  rtpmidid is an user daemon, and when a RTP MIDI device is announced using
  mDNS (also known as Zeroconf, Avahi, and multicast DNS) it exposes this ALSA
  sequencer port.

grade: devel
confinement: devmode

plugs:
  alsa-conf:
    interface: system-files
    read:
    - /etc/alsa/alsa.conf
    - /usr/share/alsa/alsa.conf

apps:
  rtpmidid:
    command: usr/sbin/rtpmidid
    daemon: forking
    restart-condition: on-failure
    plugs:
      - alsa
      - network
      - network-bind
      - avahi-control
      - avahi-observe

parts:
  rtpmidid:
    source: https://github.com/dsokoloski/rtpmidid/archive/refs/tags/v23.02.tar.gz
    plugin: cmake
    cmake-parameters:
      - -DCMAKE_INSTALL_PREFIX=/usr
    build-packages:
      - pkg-config
      - libasound2-dev
      - libavahi-client-dev
      - libfmt-dev
    stage-packages:
      - libasound2
      - libavahi-client3
